# Migration from 7.0 to 8.0

## Breaking changes

### Minimum requirements

The following versions are supported when issues arise.

- Ember 4.12 and above
- Node 20 and above
- `@ember/test-helpers` 4.x and above


### Removed `app/formats.js` support

In `v8`, reusable formats (these are optional, you don't need to use them) are expected to be defined in `app/ember-intl.{js,ts}`, not `app/formats.js`.

```ts
/* app/ember-intl.ts */
import type { Formats } from 'ember-intl';

export const formats: Formats = {
  'format-time': {
    hhmmss: {
      hour: 'numeric',
      minute: 'numeric',
      second: 'numeric',
    },
  },
};
```

Note, the key names now match the names of the `intl` service methods (dasherized):

| Usage in `intl` service | Key (before) | Key (after) |
|--|--|--|
| `formatDate()` | date | format-date |
| `formatDateRange()` | dateTimeRange | format-date-range |
| `formatNumber()` | number | format-number |
| `formatRelativeTime()` | relative | format-relative-time |
| `formatTime()` | time | format-time |

<br>

Unlike with `app/formats.js`, `ember-intl` doesn't automatically (magically) read your formats. You get to explicitly import and consume `formats`.

```ts
/* app/routes/application.ts */
import Route from '@ember/routing/route';
import { type Registry as Services, service } from '@ember/service';
import { formats } from 'my-app/ember-intl';

export default class ApplicationRoute extends Route {
  @service declare intl: Services['intl'];

  beforeModel() {
    this.intl.setFormats(formats);
    this.intl.setLocale(['en-us']);
  }
}
```

This also means, your tests will need additional setup if they depend on a particular format.

```ts
import { formats } from 'my-app/ember-intl';

module('Integration | Component | my-component', function (hooks) {
  setupIntl(hooks, 'en-us');

  hooks.beforeEach(function (this: TestContext) {
    const intl = this.owner.lookup('service:intl');

    intl.setFormats(formats);
  });
});
```


### Renamed `formatRelative()` and `{{format-relative}}`

It was unclear from the name what exactly is being compared (relative to what?).

The method and the corresponding helper are called `formatRelativeTime()` and `{{format-relative-time}}` in `v8`.

```diff
// For *.{gjs,gts,js,ts} files
- this.intl.formatRelative(-1);
+ this.intl.formatRelativeTime(-1);
```

```diff
{{! For *.hbs files }}
<div>
-   Past: {{format-relative -1}}
+   Past: {{format-relative-time -1}}
</div>
```

```diff
// For *.{gjs,gts} files
- import { formatRelative } from 'ember-intl';
+ import { formatRelativeTime } from 'ember-intl';

<template>
  <div>
-     Past: {{formatRelative -1}}
+     Past: {{formatRelativeTime -1}}
  </div>
</template>
```
